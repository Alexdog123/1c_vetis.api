
Функция BusinessEntityОрганизация(пСсылка, ПоУмолчанию = Неопределено) Экспорт
	
	Если ТипЗнч(пСсылка) = Тип("СправочникСсылка.Организации") Тогда
		Возврат ВетисСоответствие.ПолучитьGuid(пСсылка, ПоУмолчанию);
	ИначеЕсли ТипЗнч(пСсылка) = Тип("ОбъектXDTO") ИЛИ ТипЗнч(пСсылка) = Тип("Структура") Тогда
		Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка.guid, "Справочник.Организации", ПоУмолчанию);
	Иначе
		Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка, "Справочник.Организации", ПоУмолчанию);
	КонецЕсли;
	
КонецФункции

Функция BusinessEntityКонтрагент(пСсылка, ПоУмолчанию = Неопределено) Экспорт
	
	Если ТипЗнч(пСсылка) = Тип("СправочникСсылка.Контрагенты") Тогда
		Возврат ВетисСоответствие.ПолучитьGuid(пСсылка, ПоУмолчанию);
	ИначеЕсли ТипЗнч(пСсылка) = Тип("ОбъектXDTO") ИЛИ ТипЗнч(пСсылка) = Тип("Структура") Тогда
		Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка.guid, "Справочник.Контрагенты", ПоУмолчанию);
	Иначе
		Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка, "Справочник.Контрагенты", ПоУмолчанию);
	КонецЕсли;
	
КонецФункции

Функция Enterprise(пСсылка, ПоУмолчанию = Неопределено) Экспорт
	
	Если ТипЗнч(пСсылка) = Тип("СправочникСсылка.кпсПунктыНазначения") ИЛИ ТипЗнч(пСсылка) = Тип("СправочникСсылка.Склады") Тогда
		Возврат ВетисСоответствие.ПолучитьGuid(пСсылка, ПоУмолчанию);
	ИначеЕсли ТипЗнч(пСсылка) = Тип("ОбъектXDTO") ИЛИ ТипЗнч(пСсылка) = Тип("Структура") Тогда
		Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка.guid, "Справочник.кпсПунктыНазначения,Справочник.Склады", ПоУмолчанию);
	Иначе
		Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка, "Справочник.кпсПунктыНазначения,Справочник.Склады", ПоУмолчанию);
	КонецЕсли;
	
КонецФункции

Функция EnterpriseСклад(пСсылка, ПоУмолчанию = Неопределено) Экспорт
	
	Если ТипЗнч(пСсылка) = Тип("СправочникСсылка.Склады") Тогда
		Возврат ВетисСоответствие.ПолучитьGuid(пСсылка, ПоУмолчанию);
	ИначеЕсли ТипЗнч(пСсылка) = Тип("ОбъектXDTO") ИЛИ ТипЗнч(пСсылка) = Тип("Структура") Тогда
		Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка.guid, "Справочник.Склады", ПоУмолчанию);
	Иначе
		Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка, "Справочник.Склады", ПоУмолчанию);
	КонецЕсли;
	
КонецФункции

Функция EnterpriseПунктНазначения(пСсылка, ПоУмолчанию = Неопределено) Экспорт
	
	Если ТипЗнч(пСсылка) = Тип("СправочникСсылка.кпсПунктыНазначения") Тогда
		Возврат ВетисСоответствие.ПолучитьGuid(пСсылка, ПоУмолчанию);
	ИначеЕсли ТипЗнч(пСсылка) = Тип("ОбъектXDTO") ИЛИ ТипЗнч(пСсылка) = Тип("Структура") Тогда
		Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка.guid, "Справочник.кпсПунктыНазначения", ПоУмолчанию);
	Иначе
		Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка, "Справочник.кпсПунктыНазначения", ПоУмолчанию);
	КонецЕсли;
	
КонецФункции

Функция Producer(пСсылка, ПоУмолчанию = Неопределено) Экспорт
	
	Если ТипЗнч(пСсылка) = Тип("СправочникСсылка.кпсПунктыНазначения") ИЛИ ТипЗнч(пСсылка) = Тип("СправочникСсылка.Склады") Тогда
		Возврат ВетисСоответствие.ПолучитьGuid(пСсылка, ПоУмолчанию);
	ИначеЕсли ТипЗнч(пСсылка) = Тип("ОбъектXDTO") Тогда
		Если НЕ пСсылка.Свойства().Получить("guid") = Неопределено Тогда
			Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка.guid, "Справочник.кпсПунктыНазначения,Справочник.Склады", ПоУмолчанию);
		ИначеЕсли НЕ пСсылка.Свойства().Получить("enterprise") = Неопределено Тогда
			Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка.enterprise.guid, "Справочник.кпсПунктыНазначения,Справочник.Склады", ПоУмолчанию);
		ИначеЕсли НЕ пСсылка.Свойства().Получить("producer") = Неопределено И ТипЗнч(пСсылка.producer) = Тип("СписокXDTO") И пСсылка.producer.Количество() > 0 Тогда
			Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка.producer[0].enterprise.guid, "Справочник.кпсПунктыНазначения,Справочник.Склады", ПоУмолчанию);
		КонецЕсли;
	ИначеЕсли ТипЗнч(пСсылка) = Тип("Структура") Тогда
		Если пСсылка.Свойство("guid") Тогда
			Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка.guid, "Справочник.кпсПунктыНазначения,Справочник.Склады", ПоУмолчанию);
		ИначеЕсли пСсылка.Свойство("enterprise") Тогда
			Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка.enterprise.guid, "Справочник.кпсПунктыНазначения,Справочник.Склады", ПоУмолчанию);
		ИначеЕсли пСсылка.Свойство("producer") И Тип(пСсылка.producer) = Тип("Массив") И пСсылка.producer.Количество() > 0 Тогда
			Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка.producer[0].enterprise.guid, "Справочник.кпсПунктыНазначения,Справочник.Склады", ПоУмолчанию);
		КонецЕсли;
	Иначе
		Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка, "Справочник.кпсПунктыНазначения,Справочник.Склады", ПоУмолчанию);
	КонецЕсли;
	
КонецФункции

Функция BusinessEntityType(value, ПоУмолчанию = Неопределено) Экспорт
	
	Если ТипЗнч(value) = Тип("ПеречислениеСсылка.ВетисBusinessEntityType") Тогда
		Если      value = ПредопределенноеЗначение("Перечисление.ВетисBusinessEntityType.ЮрЛицо") Тогда
			Возврат 1;
		ИначеЕсли value = ПредопределенноеЗначение("Перечисление.ВетисBusinessEntityType.ФизЛицо") Тогда
			Возврат 2;
		ИначеЕсли value = ПредопределенноеЗначение("Перечисление.ВетисBusinessEntityType.ИП") Тогда
			Возврат 3;
		Иначе
			Возврат ПоУмолчанию;
		КонецЕсли;
	Иначе
		Если      value = 1 Тогда
			Возврат ПредопределенноеЗначение("Перечисление.ВетисBusinessEntityType.ЮрЛицо");
		ИначеЕсли value = 2 Тогда
			Возврат ПредопределенноеЗначение("Перечисление.ВетисBusinessEntityType.ФизЛицо");
		ИначеЕсли value = 3 Тогда
			Возврат ПредопределенноеЗначение("Перечисление.ВетисBusinessEntityType.ИП");
		Иначе
			Возврат ПоУмолчанию;
		КонецЕсли;
	КонецЕсли;
	
КонецФункции
