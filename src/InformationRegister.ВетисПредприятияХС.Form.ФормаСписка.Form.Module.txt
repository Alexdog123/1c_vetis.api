
&НаКлиенте
Процедура КомандаПривязатьВСервисе(Команда)
	
	ТекущиеДанные = Элементы.Список.ТекущиеДанные;
	
	ModifyActivityLocations(ТекущиеДанные.ХозяйствующийСубъект, ТекущиеДанные.Предприятие);
	
	ВетисХозяйственныеОперации.ОбновитьСвязиХСПредприятие();
	
	Элементы.Список.Обновить();
	
КонецПроцедуры

&НаКлиенте
Процедура КомандаОтвязатьВСервисе(Команда)
	
	ТекущиеДанные = Элементы.Список.ТекущиеДанные;
	
	ModifyActivityLocations(ТекущиеДанные.ХозяйствующийСубъект, ТекущиеДанные.Предприятие, Ложь);
	
	ВетисХозяйственныеОперации.ОбновитьСвязиХСПредприятие();
	
	Элементы.Список.Обновить();
	
КонецПроцедуры

&НаСервере
Процедура ModifyActivityLocations(пХозяйствующийСубъект, пПредприятие, CREATE = Истина)
	
	ВетисMercuryApplicationsСлой1с.ModifyActivityLocations(пХозяйствующийСубъект, пПредприятие, CREATE);
	
КонецПроцедуры

&НаКлиенте
Процедура КомандаОбновитьХСПредприятие(Команда)
	
	ВетисХозяйственныеОперации.ОбновитьСвязиХСПредприятие();
	
	Элементы.Список.Обновить();
	
КонецПроцедуры
