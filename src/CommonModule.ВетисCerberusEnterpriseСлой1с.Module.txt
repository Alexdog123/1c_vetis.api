
Функция BusinessEntity(пСсылка, ПоУмолчанию = Неопределено) Экспорт
	
	Если ТипЗнч(пСсылка) = Тип(ВетисИмяСправочника.BusinessEntity("СправочникСсылка")) Тогда
		Возврат ВетисСоответствие.ПолучитьGuid(пСсылка, ПоУмолчанию);
	ИначеЕсли ТипЗнч(пСсылка) = Тип("ОбъектXDTO") Тогда
		Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка.guid, ВетисИмяСправочника.BusinessEntity("Справочник"), ПоУмолчанию);
	Иначе
		Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка, ВетисИмяСправочника.BusinessEntity("Справочник"), ПоУмолчанию);
	КонецЕсли;
	
КонецФункции

Функция Enterprise(пСсылка, ПоУмолчанию = Неопределено) Экспорт
	
	Если ТипЗнч(пСсылка) = Тип(ВетисИмяСправочника.Enterprise("СправочникСсылка")) Тогда
		Возврат ВетисСоответствие.ПолучитьGuid(пСсылка, ПоУмолчанию);
	ИначеЕсли ТипЗнч(пСсылка) = Тип("ОбъектXDTO") Тогда
		Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка.guid, ВетисИмяСправочника.Enterprise("Справочник"), ПоУмолчанию);
	Иначе
		Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка, ВетисИмяСправочника.Enterprise("Справочник"), ПоУмолчанию);
	КонецЕсли;
	
КонецФункции

Функция Producer(пСсылка, ПоУмолчанию = Неопределено) Экспорт
	
	Если ТипЗнч(пСсылка) = Тип(ВетисИмяСправочника.Enterprise("СправочникСсылка")) Тогда
		Возврат ВетисСоответствие.ПолучитьGuid(пСсылка, ПоУмолчанию);
	ИначеЕсли ТипЗнч(пСсылка) = Тип("ОбъектXDTO") Тогда
		Если НЕ пСсылка.Свойства().Получить("guid") = Неопределено Тогда
			Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка.guid, ВетисИмяСправочника.Enterprise("Справочник"), ПоУмолчанию);
		ИначеЕсли НЕ пСсылка.Свойства().Получить("enterprise") = Неопределено Тогда
			Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка.enterprise.guid, ВетисИмяСправочника.Enterprise("Справочник"), ПоУмолчанию);
		ИначеЕсли НЕ пСсылка.Свойства().Получить("producer") = Неопределено И ТипЗнч(пСсылка.producer) = Тип("СписокXDTO") И пСсылка.producer.Количество() > 0 Тогда
			Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка.producer[0].enterprise.guid, ВетисИмяСправочника.Enterprise("Справочник"), ПоУмолчанию);
		КонецЕсли;
	Иначе
		Возврат ВетисСоответствие.ПолучитьСсылку(пСсылка, ВетисИмяСправочника.Enterprise("Справочник"), ПоУмолчанию);
	КонецЕсли;
	
КонецФункции


Функция BusinessEntityType(value, ПоУмолчанию = Неопределено) Экспорт
	
	Если ТипЗнч(value) = Тип("ПеречислениеСсылка.ВетисBusinessEntityType") Тогда
		Если      value = ПредопределенноеЗначение("Перечисление.ВетисBusinessEntityType.ЮрЛицо") Тогда
			Возврат ВетисКонстанты.BusinessEntityType_JURIDICAL();
		ИначеЕсли value = ПредопределенноеЗначение("Перечисление.ВетисBusinessEntityType.ФизЛицо") Тогда
			Возврат ВетисКонстанты.BusinessEntityType_PHYSICAL();
		ИначеЕсли value = ПредопределенноеЗначение("Перечисление.ВетисBusinessEntityType.ИП") Тогда
			Возврат ВетисКонстанты.BusinessEntityType_SELF_EMPLOYED();
		Иначе
			Возврат ПоУмолчанию;
		КонецЕсли;
	Иначе
		Если      value = ВетисКонстанты.BusinessEntityType_JURIDICAL() Тогда
			Возврат ПредопределенноеЗначение("Перечисление.ВетисBusinessEntityType.ЮрЛицо");
		ИначеЕсли value = ВетисКонстанты.BusinessEntityType_PHYSICAL() Тогда
			Возврат ПредопределенноеЗначение("Перечисление.ВетисBusinessEntityType.ФизЛицо");
		ИначеЕсли value = ВетисКонстанты.BusinessEntityType_SELF_EMPLOYED() Тогда
			Возврат ПредопределенноеЗначение("Перечисление.ВетисBusinessEntityType.ИП");
		Иначе
			Возврат ПоУмолчанию;
		КонецЕсли;
	КонецЕсли;
	
КонецФункции

Функция EnterpriseType(value) Экспорт
	
	Если ТипЗнч(value) = Тип("ПеречислениеСсылка.ВетисEnterpriseType") Тогда
		Если      value = ПредопределенноеЗначение("Перечисление.ВетисEnterpriseType.Предприятие") Тогда
			Возврат ВетисКонстанты.EnterpriseType_Предприятие();
		ИначеЕсли value = ПредопределенноеЗначение("Перечисление.ВетисEnterpriseType.Рынок") Тогда
			Возврат ВетисКонстанты.EnterpriseType_Рынок();
		ИначеЕсли value = ПредопределенноеЗначение("Перечисление.ВетисEnterpriseType.СББЖ") Тогда
			Возврат ВетисКонстанты.EnterpriseType_СББЖ();
		ИначеЕсли value = ПредопределенноеЗначение("Перечисление.ВетисEnterpriseType.Судно") Тогда
			Возврат ВетисКонстанты.EnterpriseType_Судно();
		Иначе
			Возврат 0;
		КонецЕсли;
	Иначе
		Если      value = ВетисКонстанты.EnterpriseType_Предприятие() Тогда
			Возврат ПредопределенноеЗначение("Перечисление.ВетисEnterpriseType.Предприятие");
		ИначеЕсли value = ВетисКонстанты.EnterpriseType_Рынок() Тогда
			Возврат ПредопределенноеЗначение("Перечисление.ВетисEnterpriseType.Рынок");
		ИначеЕсли value = ВетисКонстанты.EnterpriseType_СББЖ() Тогда
			Возврат ПредопределенноеЗначение("Перечисление.ВетисEnterpriseType.СББЖ");
		ИначеЕсли value = ВетисКонстанты.EnterpriseType_Судно() Тогда
			Возврат ПредопределенноеЗначение("Перечисление.ВетисEnterpriseType.Судно");
		Иначе
			Возврат ПредопределенноеЗначение("Перечисление.ВетисEnterpriseType.ПустаяСсылка");
		КонецЕсли;
	КонецЕсли;
	
КонецФункции
