
Процедура Добавить(пТекст, пКонтекст = Неопределено) Экспорт
	
	Период = ТекущаяУниверсальнаяДатаВМиллисекундах();
	
	МенеджерЗаписи = РегистрыСведений.ВетисЖурнал.СоздатьМенеджерЗаписи();
	МенеджерЗаписи.Период        = ТекущаяДата();
	МенеджерЗаписи.Миллисекунды  = Период % 1000;
	МенеджерЗаписи.Расшифровка   = пТекст;
	МенеджерЗаписи.Пользователь  = Пользователи.ТекущийПользователь();
	МенеджерЗаписи.Контекст      = пКонтекст;
	МенеджерЗаписи.Версия        = ВетисXSD.Версия();
	
	МенеджерЗаписи.Записать();
	
КонецПроцедуры

Процедура ДобавитьИнформациюОбОшибке(пИнформацияОбОшибке, пКонтекст = "") Экспорт
	
	Если ТипЗнч(пКонтекст) = Тип("Строка") Тогда
		Добавить(?(пКонтекст = "", "", Строка(пКонтекст) + ": ") + ПодробноеПредставлениеОшибки(пИнформацияОбОшибке));
	Иначе
		Добавить(ПодробноеПредставлениеОшибки(пИнформацияОбОшибке), пКонтекст);
	КонецЕсли;
	
КонецПроцедуры

Процедура Очистить() Экспорт
	
	нз = РегистрыСведений.ВетисЖурнал.СоздатьНаборЗаписей();
	нз.Записать();
	
КонецПроцедуры
